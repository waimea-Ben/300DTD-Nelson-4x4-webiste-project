{#=====================================================
  admin page
=====================================================#}

{% extends 'pages/base.jinja' %}


{% block title %}

    Admin

{% endblock %}


{% block content %}

 <h1>Admin</h1>

<div class="tab-bar">
    <a href="/admin/settings" class="tab">settings</a>
    <a href="/admin/trips" class="tab">trips</a>
    <a href="/admin/members" class="tab active">Members</a>
    
</div>  

<section class="members-list">
    <header>
    <br>
        <h2>Member Management</h2>
        <p>Add, edit, and manage current members</p>
    </header>

    <form action="/members" method="get">
        <input type="text" name="q" value="{{ search_text }}" placeholder="Search members...">
        <button type="submit">Search</button>
    </form>

    {% if members %}
        {% for member in members %}
            <article id="member-{{ member.id }}">
                {% include 'components/member_details.jinja' %}
            </article>
        {% endfor %}
    {% else %}
        <p>No members found.</p>
    {% endif %}

</section>



{% endblock %}
<javascript>
document.querySelectorAll('.edit-button').forEach(button => {
  button.addEventListener('click', async (e) => {
    e.preventDefault();

    const memberId = button.dataset.memberId;
    // Fetch the form HTML from your server endpoint
    const response = await fetch(`/members/${memberId}/edit`);
    if (!response.ok) {
      alert('Failed to load form');
      return;
    }
    const formHtml = await response.text();

    // Show popup and insert form HTML
    document.getElementById('modalContent').innerHTML = formHtml;
    document.getElementById('editModal').style.display = 'block';
    document.getElementById('modalOverlay').style.display = 'block';
  });
});

document.getElementById('closeModal').addEventListener('click', () => {
  document.getElementById('editModal').style.display = 'none';
  document.getElementById('modalOverlay').style.display = 'none';
});
</javascript>